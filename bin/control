#!/bin/bash -e
source $OPENSHIFT_CARTRIDGE_SDK_BASH


function start() {
    echo "Starting Cron cartridge"
    if _are_cronjobs_enabled; then
        client_result "cron scheduling service is already enabled for gear $OPENSHIFT_GEAR_UUID"
    else
        touch "$OPENSHIFT_CRON_DIR/run/jobs.enabled"
    fi
}

function stop() {
    echo "Stopping Cron cartridge"
    if _are_cronjobs_enabled; then
        rm -f $OPENSHIFT_CRON_DIR/run/jobs.enabled
    else
        client_result "cron scheduling service is already disabled for gear $OPENSHIFT_GEAR_UUID"
    fi
}

function restart() {
	stop
    start
}



function tidy() {
  client_message "Emptying cron logs in dir: $OPENSHIFT_LOG_DIR"
  shopt -s dotglob
  rm -rf $OPENSHIFT_LOG_DIR/cron_*
}

case "$1" in
  start)     start ;;
  stop)      stop ;;
  restart)   restart ;;
  *)         exit 0
esac